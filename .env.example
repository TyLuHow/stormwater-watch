# ============================================================================
# STORMWATER WATCH - ENVIRONMENT CONFIGURATION TEMPLATE
# ============================================================================
#
# This template documents all required environment variables for the Stormwater
# Watch platform. Copy this file to .env.local and fill in your values.
#
# SECURITY WARNING: Never commit actual .env files to version control.
# Keep all sensitive keys and API tokens secure.
#
# For setup instructions, see ENV_SETUP_STATUS.md in the project root.
# For a complete variable reference, see ENV_VARIABLES.md
#
# ============================================================================

# ============================================================================
# DATABASE CONFIGURATION (Supabase)
# ============================================================================
# Supabase provides a PostgreSQL database with built-in authentication.
# All 4 keys are required for database connectivity.

# PostgreSQL connection string
# Format: postgresql://username:password@host:port/database
# Obtain from: Supabase Dashboard > Settings > Database > Connection String
# Select "Postgres" and copy the pooler connection string
# SECURITY: Contains database password - handle with care
DATABASE_URL=postgresql://postgres.xxxxx:[PASSWORD]@aws-0-us-east-1.pooler.supabase.co:6543/postgres?pgbouncer=true

# Supabase project URL
# Format: https://[PROJECT_ID].supabase.co
# Obtain from: Supabase Dashboard > Settings > API > Project URL
SUPABASE_URL=https://your-project-id.supabase.co

# Supabase anonymous key (public - safe to expose to browser)
# Used for public-facing operations with RLS policies
# Obtain from: Supabase Dashboard > Settings > API > anon key
SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.xxxxx...

# Supabase service role key (private - never expose to browser)
# Used for server-side operations with full database access
# Obtain from: Supabase Dashboard > Settings > API > service_role key
# SECURITY: Never expose this to the frontend - use only in API routes
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.xxxxx...

# ============================================================================
# AUTHENTICATION (NextAuth.js)
# ============================================================================
# NextAuth.js handles user authentication and session management.

# Application URL for authentication redirects
# Local: http://localhost:3000
# Production: https://yourdomain.com
# Important: Must match your deployment URL exactly
NEXTAUTH_URL=http://localhost:3000

# Secret key for encrypting sessions and tokens
# Generate using: openssl rand -base64 32
# Or: node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
# SECURITY: Use a strong, random value - never share or hardcode in code
NEXTAUTH_SECRET=your-random-secret-string-here-minimum-32-chars

# ============================================================================
# EMAIL SERVICE (Resend)
# ============================================================================
# Resend is used for sending transactional emails (alerts, notifications).
# Both keys are required for email functionality.

# Resend API key for sending emails
# Obtain from: https://resend.com > API Keys
# SECURITY: Keep this private - it can send emails from your account
RESEND_API_KEY=re_xxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# From address for emails (include display name)
# Format: "Name <email@domain.com>"
# Should be from a verified domain in your Resend account
# Obtain verified domains from: https://resend.com > Domains
RESEND_FROM_EMAIL="Stormwater Watch <alerts@yourdomain.org>"

# ============================================================================
# MAPPING SERVICE (Mapbox)
# ============================================================================
# Mapbox provides interactive maps for water quality visualization.

# Mapbox public token (safe for browser/frontend use)
# Prefix: pk.eyJ...
# Obtain from: https://account.mapbox.com > Tokens > Create token
# Scope: public.readOnly (for map display)
NEXT_PUBLIC_MAPBOX_TOKEN=pk.eyJ1IjoieW91cnVzZXJuYW1lIiwiYSI6ImNpxxxxxxxxxx...

# Mapbox private token (for server-side operations)
# Prefix: pk.eyJ... (same token or separate if needed)
# Used in API routes for tile manipulation and advanced features
MAPBOX_TOKEN=pk.eyJ1IjoieW91cnVzZXJuYW1lIiwiYSI6ImNpxxxxxxxxxx...

# ============================================================================
# MESSAGE QUEUE & CACHING (Upstash Redis)
# ============================================================================
# Upstash provides Redis for job queues and caching.
# Both values required for queue functionality.

# Upstash Redis REST API URL
# Format: https://[name].upstash.io
# Obtain from: https://console.upstash.com > Redis > [database] > REST API
UPSTASH_REDIS_REST_URL=https://yourdb-name.upstash.io

# Upstash Redis REST token for authentication
# Obtain from: https://console.upstash.com > Redis > [database] > REST API > Token
# SECURITY: Authenticate your REST requests - keep private
UPSTASH_REDIS_REST_TOKEN=AUcoAAIncDJlxxxxxxxxxxxxxxxxxxxxxxxxxx

# ============================================================================
# SCHEDULED JOBS (Cron Security)
# ============================================================================
# Secret token for securing scheduled job endpoints.

# Secret for authenticating cron job requests
# Prevents unauthorized trigger of scheduled tasks
# Generate using: openssl rand -hex 16
# SECURITY: Strong random value required for production
CRON_SECRET=a8b9c0d1e2f3g4h5i6j7k8l9m0n1o2p3

# ============================================================================
# EXTERNAL APIS
# ============================================================================
# Configuration for external services used by the platform.

# User-Agent for National Weather Service (NWS) API requests
# Format: application-name (contact-email)
# NWS requires a descriptive User-Agent - email should be your contact
# Used for: Weather alerts, flood warnings, water quality data
NWS_USER_AGENT=stormwater-watch.org (your-email@domain.org)

# ============================================================================
# OPTIONAL: MONITORING & NOTIFICATIONS (Slack)
# ============================================================================
# Slack integration for alerts and error monitoring.
# Leave empty to disable Slack integration.

# Slack webhook URL for sending notifications
# Obtain from: https://api.slack.com > Create New App > Incoming Webhooks
# Format: https://hooks.slack.com/services/T00000000/B00000000/XXXXXXXXXXXXXXXXXXXX
# SECURITY: Webhook URLs contain sensitive credentials - keep private
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/T00000000/B00000000/XXXX

# Slack channel for alert notifications
# Format: #channel-name or U1234567890 (user ID)
# If empty, uses default channel configured in webhook
SLACK_CHANNEL=#stormwater-alerts

# ============================================================================
# OPTIONAL: AI FEATURES (InterVL Vision Model)
# ============================================================================
# Advanced computer vision capabilities for satellite imagery analysis.
# Leave disabled (false) unless you have InterVL access.

# Enable AI-powered image analysis features
# Values: "true" or "false"
# If false, INTERNVL_BASE_URL is ignored
INTERNVL_ENABLED=false

# Base URL for InterVL API (only needed if INTERNVL_ENABLED=true)
# Format: https://api.internvl.com or your self-hosted instance
# Contact admin for access URL
INTERNVL_BASE_URL=https://api.internvl.com

# ============================================================================
# APPLICATION SETTINGS
# ============================================================================
# General application configuration.

# Node.js environment
# Values: "development" or "production"
# Affects logging level, error handling, and feature flags
NODE_ENV=development

# Public application URL
# Used for generating links in emails and external references
# Local: http://localhost:3000
# Production: https://yourdomain.com
# Note: Should match NEXTAUTH_URL for consistency
NEXT_PUBLIC_APP_URL=http://localhost:3000

# ============================================================================
# SETUP INSTRUCTIONS
# ============================================================================
#
# 1. Copy this file:     cp .env.example .env.local
# 2. Create accounts:    Set up Supabase, Resend, Mapbox, Upstash
# 3. Gather keys:        From each service's dashboard
# 4. Fill in values:     Replace all xxx... placeholders
# 5. Verify setup:       Run: npm run init:db
# 6. Test connection:    Run: npm run dev
#
# Common issues and solutions in DEPLOYMENT.md
#
# ============================================================================